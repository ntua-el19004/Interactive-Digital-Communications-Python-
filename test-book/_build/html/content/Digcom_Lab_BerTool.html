
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>BER Tool: ASK - QAM - PSK - FSK - MSK &#8212; Interactive Digital Communtications</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"021bdf7f7e0648f8840a8e9921b8d27f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatTextModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatTextModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "FloatTextView", "continuous_update": false, "description": "Roll-off:", "description_allow_html": false, "disabled": false, "layout": "IPY_MODEL_b16611fd9c3a460d9fd9d6bf33128529", "step": null, "style": "IPY_MODEL_edeff69cc03b4237b746daf5e0e3f25c", "tabbable": null, "tooltip": null, "value": 0.25}}, "03aa9556da61447f8acc4c5adc008cac": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "description_width": ""}}, "040e698284e44a8f95e1dc6a4fbe8262": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0f49b119c3f344318471d1e32b066b4a": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "152dad19557f411392ec24853871a57f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ButtonModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ButtonView", "button_style": "primary", "description": "Plot", "disabled": false, "icon": "", "layout": "IPY_MODEL_5e9205e85d2f4eef9d4ee2e797e5121d", "style": "IPY_MODEL_47b12ad741ad427490c9e062557a83b5", "tabbable": null, "tooltip": null}}, "15f82bed61c24f0194d486d5194ed311": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "VBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_dbcfa06f49984390b69784fe52506cc4", "IPY_MODEL_152dad19557f411392ec24853871a57f"], "layout": "IPY_MODEL_5636db9840534d849fe4c86140b49ae6", "tabbable": null, "tooltip": null}}, "20487921ea0c4e088d8f154747474da1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatTextModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatTextModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "FloatTextView", "continuous_update": false, "description": "F2: (MHz)", "description_allow_html": false, "disabled": false, "layout": "IPY_MODEL_8d3265676a3647c2b4ffa67970dc2a5b", "step": null, "style": "IPY_MODEL_c20ba050827845c49331dcd63d79ac40", "tabbable": null, "tooltip": null, "value": 9.25}}, "226240db4d41414587b98ba3494d9ab6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "description_width": ""}}, "32263011a84946f5a3f85a121cff8676": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_e9bbc60817f74eb3ba4d2fa1b26ea9fe", "msg_id": "", "outputs": [{"data": {"image/png": "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qVP45ptvNEvLe3h4aLY3SkxMLHbJ9iFDhsDR0RG9e/fGyZMncffuXfz55584ffo0AMDT0xPbtm1DWFgYwsPDMXToUM0oXUnNnTsXU6ZMwZo1a+Dh4YHY2FjExsYiPT39ud+zevVq9O/fH3Xr1i309c477yAxMRH79+/H48eP0b59e/z666+4dOkSIiMj8ccff2DevHno1avXc1+3PXv2YPXq1eV6YTyGrPLs3qnCUwSLEIHUB+p2RERERKR1AQEB2LNnDw4ePIimTZuiefPmWLRoEdzd3QGopxfu3LkTVlZWaNOmDTp27Ihq1arh999/f+F5BUHAvn370KZNG4wePRo1a9bE4MGDce/ePc1WRf369UPnzp3Rrl072NnZYfPmzUXOY2BggIMHD8Le3h5du3ZFvXr1MGfOHM0o0cKFC2FlZYWWLVuiR48eCAgIQKNGjUr1Gixbtgy5ubno378/nJycNF/z588vtv358+cRHh6Ofv36FbnPwsICHTp0wOrVq2FqaopmzZph0aJFaNOmDerWrYspU6YgMDAQS5cufW497du3x969exEUFIQPP/ywxMv6v0mCWB6rKkdSU1NhYWGBlJQUmJubv9kHv7wV+POdlzabb/YFHlftCS9nC3g5maOOk1mFnyOdl5eHffv2oWvXroXmSVPFxT7VPexT3cR+1T3a6NPs7GxERkYW2uOJpKVSqZCamgpzc3PIZBw30aYX/byXNBtU7Hfius60ZBsun3uswJmEGAAxAABBAKramsDLyRzezhbwcjaHt7M5bE2fv/cAERERERFpB0NWeebeUr2KYOojFHddlggBSlMnDO80BI1j03H1YSquPUxFfFoO7iZk4G5CBvZceqRpb2+m0AQuLycLeDubw83aGDKZ8AafFBERERGRbmPIKs9kcvUy7VtGABBQOGgJEADodZ2Lbl4u6PbfHnNISMvBtUfqwHX1YQquPUpFZGIG4tNyEH8jAUdvJGjamir0UMfJDF5O5v8GMAt4OphCocc9uIiIiIiIXgVDVnnn1VO9THux+2TNKXb5djszBfzM7OBX878N7zJy8hERm4Zr/4auaw9TERGbhvScfJyNeoKzUU80bfVkAmrYm8LL2fy/KYdO5rAw5tx8IiIiIqKXYciqCLx6ArW7qVcRTI9TX6vl3lI90lVCJgo9NHa3QmN3K82xfKUKdxMz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", "text/plain": "<Figure size 1000x700 with 1 Axes>"}, "metadata": {}, "output_type": "display_data"}], "tabbable": null, "tooltip": null}}, "47b12ad741ad427490c9e062557a83b5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ButtonStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ButtonStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "button_color": null, "font_family": null, "font_size": null, "font_style": null, "font_variant": null, "font_weight": null, "text_color": null, "text_decoration": null}}, "4e27536683da4944aa54a2c02d2708c3": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "VBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_c56666b15cdf4838a4648a0a5af08bea", "IPY_MODEL_53ec7e52abab42d2be36448a6a8736c6"], "layout": "IPY_MODEL_5cef49cf21ce441792b36eb1c83dba82", "tabbable": null, "tooltip": null}}, "53ec7e52abab42d2be36448a6a8736c6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "DropdownModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DropdownModel", "_options_labels": ["2-ASK", "4-ASK", "8-ASK", "16-ASK", "32-ASK", "64-ASK"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "DropdownView", "description": "Levels:", "description_allow_html": false, "disabled": false, "index": 0, "layout": "IPY_MODEL_eebe7fa221d4477797aab6ad4d6efbc6", "style": "IPY_MODEL_03aa9556da61447f8acc4c5adc008cac", "tabbable": null, "tooltip": null}}, "5636db9840534d849fe4c86140b49ae6": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5cef49cf21ce441792b36eb1c83dba82": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5e9205e85d2f4eef9d4ee2e797e5121d": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "65fd37186ac54dcbaf807c3f2888ddb3": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "68968b10b16f4a26aefe09827e65d6db": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "description_width": ""}}, "799d95f277214f288eb3b666f294297f": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7f56527727994195b505ee15022f964b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "848b676bab044e7486668cd3f54a4394": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "description_width": ""}}, "8c6d47103eb7455bba10087a96d753bb": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8d3265676a3647c2b4ffa67970dc2a5b": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8efab39c0a53456dbe5c634407901c37": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_0f49b119c3f344318471d1e32b066b4a", "placeholder": "\u200b", "style": "IPY_MODEL_7f56527727994195b505ee15022f964b", "tabbable": null, "tooltip": null, "value": "\n        <div style='display: flex; justify-content: center; align-items: center; height: 80px;'>\n            <div style='font-size: 40px; color: #01cc97;'>&#10003;</div>\n        </div>\n        "}}, "9d245ae65fda43378394729b8e55321c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatTextModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatTextModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "FloatTextView", "continuous_update": false, "description": "Br: (Mbps)", "description_allow_html": false, "disabled": false, "layout": "IPY_MODEL_040e698284e44a8f95e1dc6a4fbe8262", "step": null, "style": "IPY_MODEL_68968b10b16f4a26aefe09827e65d6db", "tabbable": null, "tooltip": null, "value": 10.0}}, "9d4f2a38d7e24126a51b2afd964e11b9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "VBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_021bdf7f7e0648f8840a8e9921b8d27f", "IPY_MODEL_9d245ae65fda43378394729b8e55321c"], "layout": "IPY_MODEL_ef8dffd7c06c4512a7d4204deb53d482", "tabbable": null, "tooltip": null}}, "b16611fd9c3a460d9fd9d6bf33128529": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c20ba050827845c49331dcd63d79ac40": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "description_width": ""}}, "c56666b15cdf4838a4648a0a5af08bea": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "DropdownModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DropdownModel", "_options_labels": ["ASK", "QAM", "PSK", "FSK", "MSK"], "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "DropdownView", "description": "Modulation:", "description_allow_html": false, "disabled": false, "index": 0, "layout": "IPY_MODEL_799d95f277214f288eb3b666f294297f", "style": "IPY_MODEL_848b676bab044e7486668cd3f54a4394", "tabbable": null, "tooltip": null}}, "c63cf70bebd941cbae699601fe390723": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_df94401fd7054bb3891f7e002eb7d03e", "placeholder": "\u200b", "style": "IPY_MODEL_65fd37186ac54dcbaf807c3f2888ddb3", "tabbable": null, "tooltip": null, "value": "Elapsed time: 0.18 seconds"}}, "c905acfd174a492990ea45be91b68e1d": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": "center", "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ce9164d1d7d646c2b75af0d47aea4d9d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatTextModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatTextModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "FloatTextView", "continuous_update": false, "description": "F1: (MHz)", "description_allow_html": false, "disabled": false, "layout": "IPY_MODEL_8c6d47103eb7455bba10087a96d753bb", "step": null, "style": "IPY_MODEL_226240db4d41414587b98ba3494d9ab6", "tabbable": null, "tooltip": null, "value": 6.75}}, "dbcfa06f49984390b69784fe52506cc4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_4e27536683da4944aa54a2c02d2708c3", "IPY_MODEL_fa5c167dd16b4e93a5813fbddab922c7"], "layout": "IPY_MODEL_c905acfd174a492990ea45be91b68e1d", "tabbable": null, "tooltip": null}}, "df94401fd7054bb3891f7e002eb7d03e": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e52bd95c820d4c3abc8b4d9d8071cb1f": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": "0 0 0 20px", "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "auto"}}, "e9bbc60817f74eb3ba4d2fa1b26ea9fe": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "edeff69cc03b4237b746daf5e0e3f25c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "DescriptionStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "description_width": ""}}, "eebe7fa221d4477797aab6ad4d6efbc6": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ef8dffd7c06c4512a7d4204deb53d482": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fa5c167dd16b4e93a5813fbddab922c7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "VBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_8efab39c0a53456dbe5c634407901c37", "IPY_MODEL_c63cf70bebd941cbae699601fe390723"], "layout": "IPY_MODEL_e52bd95c820d4c3abc8b4d9d8071cb1f", "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/Digcom_Lab_BerTool';</script>
    <script src="../_static/custom.js?v=8345a7c9"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Lab Exercise 6: FSK-MSK" href="Digcom_Lab6.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Interactive Digital Communtications - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Interactive Digital Communtications - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">About</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../digital_communications_intro.html">Digital Communications and Interactivity</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lab Exercises</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab1.html">Lab Exercise 1: Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab2.html">Lab Exercise 2: Digital Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab3.html">Lab Exercise 3: Matched Filters and L-ASK</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab4.html">Lab Exercise 4: Nyquist signaling and L-ASK</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab5.html">Lab Exercise 5: QAM-PSK</a></li>
<li class="toctree-l1"><a class="reference internal" href="Digcom_Lab6.html">Lab Exercise 6: FSK-MSK</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bit Error Rate Tool</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">BER Tool: ASK - QAM - PSK - FSK - MSK</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ntua-el17840/Interactive-Digital-Communications" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ntua-el17840/Interactive-Digital-Communications/issues/new?title=Issue%20on%20page%20%2Fcontent/Digcom_Lab_BerTool.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/content/Digcom_Lab_BerTool.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>BER Tool: ASK - QAM - PSK - FSK - MSK</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-packages-we-will-need-later-in-python">Importing packages we will need later in Python</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bit-error-rate-tool">Bit Error Rate Tool</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="ber-tool-ask-qam-psk-fsk-msk">
<h1>BER Tool: ASK - QAM - PSK - FSK - MSK<a class="headerlink" href="#ber-tool-ask-qam-psk-fsk-msk" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>The following tool can be used to measure the bit error rate (BER) for various modulation schemes. For each, multiple configurations are available.</p></li>
<li><p>In addition to providing theoretical BER versus Eb/No curves, this tool allows users to run simulations by defining their own error and BER functions, offering a customizable and interactive approach to analyzing the performance of different modulation schemes in various conditions.</p></li>
</ul>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Link to this heading">#</a></h2>
<div class="admonition-live-code admonition">
<p class="admonition-title">Live Code</p>
<p>Press the following button to make python code interactive. It will connect you to a kernel once it says “ready” (might take a bit, especially the first time it runs).</p>
</div>
<div style="text-align: center;">
  <button title="Launch thebe" class="thebelab-button thebe-launch-button" onclick="initThebe()">Python Interactive Code</button>
</div>
<section id="importing-packages-we-will-need-later-in-python">
<h3>Importing packages we will need later in Python<a class="headerlink" href="#importing-packages-we-will-need-later-in-python" title="Link to this heading">#</a></h3>
<div class="cell tag_thebe-init tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">RadioButtons</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">clear_output</span>
<span class="kn">import</span> <span class="nn">scipy.signal</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">upfirdn</span><span class="p">,</span> <span class="n">welch</span><span class="p">,</span> <span class="n">decimate</span><span class="p">,</span> <span class="n">convolve</span><span class="p">,</span> <span class="n">firwin2</span><span class="p">,</span> <span class="n">lfilter</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">erfc</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">Checkbox</span><span class="p">,</span> <span class="n">Button</span><span class="p">,</span> <span class="n">Output</span><span class="p">,</span> <span class="n">VBox</span><span class="p">,</span> <span class="n">HBox</span><span class="p">,</span> <span class="n">Dropdown</span><span class="p">,</span> <span class="n">Layout</span>
<span class="kn">from</span> <span class="nn">commpy.channels</span> <span class="kn">import</span> <span class="n">awgn</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Libraries added successfully!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="bit-error-rate-tool">
<h2>Bit Error Rate Tool<a class="headerlink" href="#bit-error-rate-tool" title="Link to this heading">#</a></h2>
<div class="cell tag_thebe-init tag_hide-code-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loading animation</span>
<span class="n">loading</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;div style=&#39;display: flex; justify-content: center; align-items: center; height: 80px;&#39;&gt;</span>
<span class="s2">        &lt;div class=&#39;loader&#39; style=&#39;border: 12px solid #f3f3f3; /* Light grey */</span>
<span class="s2">                                     border-top: 12px solid #01cc97; /* Blue */</span>
<span class="s2">                                     border-radius: 50%;</span>
<span class="s2">                                     width: 40px;</span>
<span class="s2">                                     height: 40px;</span>
<span class="s2">                                     animation: spin 2s linear infinite;&#39;&gt;&lt;/div&gt;</span>
<span class="s2">    &lt;/div&gt;</span>
<span class="s2">    &lt;style&gt;</span>
<span class="s2">    @keyframes spin {</span>
<span class="s2">        0% { transform: rotate(0deg); }</span>
<span class="s2">        100% { transform: rotate(360deg); }</span>
<span class="s2">    }</span>
<span class="s2">    &lt;/style&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="n">done</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        &lt;div style=&#39;display: flex; justify-content: center; align-items: center; height: 80px;&#39;&gt;</span>
<span class="s2">            &lt;div style=&#39;font-size: 40px; color: #01cc97;&#39;&gt;&amp;#10003;&lt;/div&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span>
<span class="n">loader_html3</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
  <span class="n">value</span><span class="o">=</span><span class="n">loading</span>
<span class="p">)</span>
<span class="n">timer_html3</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Elapsed time: - seconds&quot;</span>
<span class="p">)</span>

<span class="c1"># Define the modulation schemes and levels</span>
<span class="n">modulation_schemes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;ASK&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2-ASK&#39;</span><span class="p">,</span> <span class="s1">&#39;4-ASK&#39;</span><span class="p">,</span> <span class="s1">&#39;8-ASK&#39;</span><span class="p">,</span> <span class="s1">&#39;16-ASK&#39;</span><span class="p">,</span> <span class="s1">&#39;32-ASK&#39;</span><span class="p">,</span> <span class="s1">&#39;64-ASK&#39;</span><span class="p">],</span>
    <span class="s1">&#39;QAM&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;4-QAM&#39;</span><span class="p">,</span> <span class="s1">&#39;16-QAM&#39;</span><span class="p">,</span> <span class="s1">&#39;64-QAM&#39;</span><span class="p">],</span>
    <span class="s1">&#39;PSK&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2-PSK&#39;</span><span class="p">,</span> <span class="s1">&#39;4-PSK&#39;</span><span class="p">,</span> <span class="s1">&#39;8-PSK&#39;</span><span class="p">],</span>
    <span class="s1">&#39;FSK&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2-FSK&#39;</span><span class="p">,</span> <span class="s1">&#39;4-FSK&#39;</span><span class="p">,</span> <span class="s1">&#39;8-FSK&#39;</span><span class="p">,</span> <span class="s1">&#39;16-FSK&#39;</span><span class="p">,</span> <span class="s1">&#39;32-FSK&#39;</span><span class="p">],</span>
    <span class="s1">&#39;MSK&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;MSK (with precoding)&#39;</span><span class="p">,</span> <span class="s1">&#39;MSK (without precoding)&#39;</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># Dropdown for modulation schemes</span>
<span class="n">modulation_dropdown</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
    <span class="n">options</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">modulation_schemes</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
    <span class="n">value</span><span class="o">=</span><span class="s1">&#39;ASK&#39;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Modulation:&#39;</span>
<span class="p">)</span>

<span class="c1"># Dropdown for levels</span>
<span class="n">levels_dropdown</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Levels:&#39;</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">update_levels_dropdown</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">levels_dropdown</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">modulation_schemes</span><span class="p">[</span><span class="n">modulation_dropdown</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
    <span class="n">levels_dropdown</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">levels_dropdown</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Set default value</span>


<span class="n">modulation_dropdown</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_levels_dropdown</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="n">update_levels_dropdown</span><span class="p">()</span>  <span class="c1"># Initialize the levels dropdown</span>

<span class="n">plot_output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">ask_errors</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">,</span> <span class="n">EbN0_db</span><span class="p">):</span>
    <span class="n">L</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">k</span>
    <span class="n">SNR_db</span> <span class="o">=</span> <span class="n">EbN0_db</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">nsamp</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">))</span>
    <span class="n">SNR</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">SNR_db</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">L</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">M</span><span class="p">))</span> <span class="o">-</span> <span class="n">L</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">P_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>
    <span class="n">Measured_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="n">y</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">*</span> <span class="n">nsamp</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Measured_x</span> <span class="o">/</span> <span class="n">SNR</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="n">y_noisy</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">noise</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">y_noisy</span><span class="p">,</span> <span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">))</span>
    <span class="n">matched</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">nsamp</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">matched</span><span class="p">)</span> <span class="o">/</span> <span class="n">nsamp</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)):</span>
        <span class="n">differences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">differences</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">differences</span> <span class="o">==</span> <span class="n">m</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">errors</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="k">return</span> <span class="n">errors</span>


<span class="k">def</span> <span class="nf">rootRaisedCosine</span><span class="p">(</span><span class="n">nsamp</span><span class="p">,</span> <span class="n">roll_off</span><span class="p">,</span> <span class="n">delay</span><span class="p">):</span>
    <span class="n">F0</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">nsamp</span>
    <span class="n">Br</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">Fs</span> <span class="o">=</span> <span class="n">Br</span> <span class="o">*</span> <span class="n">nsamp</span>
    <span class="n">Td</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Br</span>
    <span class="n">Ts</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Fs</span>
    <span class="n">F1</span> <span class="o">=</span> <span class="n">F0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">roll_off</span><span class="p">)</span>
    <span class="n">F2</span> <span class="o">=</span> <span class="n">F0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">roll_off</span><span class="p">)</span>
    <span class="n">filter_order</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">nsamp</span> <span class="o">*</span> <span class="n">delay</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">filter_order</span><span class="p">,</span> <span class="n">Td</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
        <span class="n">t_shifted</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">filter_order</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">t_shifted</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">F0</span><span class="p">)</span> <span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">roll_off</span> <span class="o">*</span> <span class="p">((</span><span class="mi">4</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">t_shifted</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">8</span> <span class="o">/</span> <span class="n">roll_off</span> <span class="o">/</span> <span class="n">F0</span> <span class="ow">or</span> <span class="n">t_shifted</span> <span class="o">==</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">8</span> <span class="o">/</span> <span class="n">roll_off</span> <span class="o">/</span> <span class="n">F0</span> <span class="p">:</span>
            <span class="n">h</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">roll_off</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">F0</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">/</span> <span class="n">roll_off</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">/</span> <span class="n">roll_off</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">factor1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">F0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">64</span> <span class="o">*</span> <span class="n">roll_off</span> <span class="o">*</span> <span class="n">roll_off</span> <span class="o">*</span> <span class="n">F0</span> <span class="o">*</span> <span class="n">F0</span> <span class="o">*</span> <span class="n">t_shifted</span> <span class="o">*</span> <span class="n">t_shifted</span><span class="p">)</span>
            <span class="n">factor2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">F1</span> <span class="o">*</span> <span class="n">t_shifted</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">F0</span> <span class="o">*</span> <span class="n">t_shifted</span><span class="p">)</span>
            <span class="n">factor3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">roll_off</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">F2</span> <span class="o">*</span> <span class="n">t_shifted</span><span class="p">)</span>
            <span class="n">h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">factor1</span> <span class="o">*</span> <span class="p">(</span><span class="n">factor2</span> <span class="o">+</span> <span class="n">factor3</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">h</span>


<span class="k">def</span> <span class="nf">qam_errors</span><span class="p">(</span><span class="n">EbNo</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">roll_off</span><span class="p">,</span> <span class="n">F1</span><span class="p">,</span> <span class="n">F2</span><span class="p">,</span> <span class="n">Br</span><span class="p">):</span>
    <span class="n">F1</span> <span class="o">=</span> <span class="n">F1</span> <span class="o">*</span> <span class="mf">1e6</span>  <span class="c1"># Convert MHz to Hz</span>
    <span class="n">F2</span> <span class="o">=</span> <span class="n">F2</span> <span class="o">*</span> <span class="mf">1e6</span>  <span class="c1"># Convert MHz to Hz</span>
    <span class="n">Br</span> <span class="o">=</span> <span class="n">Br</span> <span class="o">*</span> <span class="mf">1e6</span>  <span class="c1"># Convert Mbps to Hz</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">F2</span> <span class="o">-</span> <span class="n">F1</span>  <span class="c1"># Bandwidth in Hz</span>
    <span class="n">fc</span> <span class="o">=</span> <span class="n">F1</span> <span class="o">+</span> <span class="n">W</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># Carrier frequency</span>
    <span class="n">nsamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">F2</span> <span class="o">/</span> <span class="n">Br</span><span class="p">))</span> <span class="o">+</span><span class="mi">7</span>  <span class="c1"># Number of samples per symbol</span>

    <span class="n">a</span> <span class="o">=</span> <span class="mf">0.25</span>
    <span class="n">L</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">l</span>
    <span class="n">Nsymb</span> <span class="o">=</span> <span class="mi">10000</span>
    <span class="n">SNR</span> <span class="o">=</span> <span class="n">EbNo</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">nsamp</span> <span class="o">/</span> <span class="n">k</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># σε db</span>
    <span class="n">core</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">]</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="n">core</span><span class="p">[:]</span>
    <span class="k">if</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">)):</span>
            <span class="n">mapping</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">core</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mapping</span><span class="p">))</span>
            <span class="n">conj_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span>
            <span class="n">mapping</span> <span class="o">=</span> <span class="n">mapping</span> <span class="o">+</span> <span class="n">conj_arr</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">conj_arr</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">mapping</span><span class="p">)</span>
            <span class="n">mapping</span> <span class="o">=</span> <span class="n">mapping</span> <span class="o">+</span> <span class="n">conj_arr</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># Generate random sequence</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">Nsymb</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">x_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">k</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)))</span>
    <span class="n">xsym</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Split the list into sublists and put the contents of each sublist</span>
    <span class="c1"># into a string so that with the int() command it is converted from binary to decimal</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_temp</span><span class="p">)):</span>
        <span class="n">my_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">x_temp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">M</span><span class="p">))):</span>
            <span class="n">my_str</span> <span class="o">=</span> <span class="n">my_str</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
        <span class="n">a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">my_str</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">xsym</span> <span class="o">=</span> <span class="n">xsym</span> <span class="o">+</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>

    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xsym</span><span class="p">)):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="p">[</span><span class="n">mapping</span><span class="p">[</span><span class="n">xsym</span><span class="p">[</span><span class="n">n</span><span class="p">]]]</span>

    <span class="n">delay</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">filtorder</span> <span class="o">=</span> <span class="n">delay</span> <span class="o">*</span> <span class="n">nsamp</span> <span class="o">*</span> <span class="mi">2</span>

    <span class="n">shaping_filter</span> <span class="o">=</span> <span class="n">rootRaisedCosine</span><span class="p">(</span><span class="n">nsamp</span><span class="p">,</span> <span class="n">roll_off</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>
    <span class="n">ytx</span> <span class="o">=</span> <span class="n">upfirdn</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">)</span>  <span class="c1"># upsample</span>
    <span class="n">ytx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">ytx</span><span class="p">,</span> <span class="n">shaping_filter</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ytx</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">ytx</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fc</span> <span class="o">*</span> <span class="n">m</span> <span class="o">/</span> <span class="n">nsamp</span><span class="p">)))</span>

    <span class="n">s_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  <span class="c1"># transpose</span>
    <span class="n">s_matrix</span> <span class="o">=</span> <span class="n">s_matrix</span><span class="o">.</span><span class="n">getH</span><span class="p">()</span>
    <span class="n">s_list</span> <span class="o">=</span> <span class="n">s_matrix</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">Ps</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s_list</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>  <span class="c1"># Power of complex signal in dB</span>
    <span class="n">Pn</span> <span class="o">=</span> <span class="n">Ps</span> <span class="o">-</span> <span class="n">SNR</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">Pn</span> <span class="o">/</span> <span class="mi">10</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ytx</span><span class="p">))</span>
    <span class="n">snoisy</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="n">n</span>

    <span class="c1"># receiver</span>
    <span class="n">yrx</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">snoisy</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fc</span> <span class="o">*</span> <span class="n">m</span> <span class="o">/</span> <span class="n">nsamp</span><span class="p">))</span>
    <span class="n">yrx</span> <span class="o">=</span> <span class="n">yrx</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">yrx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">yrx</span><span class="p">,</span> <span class="n">shaping_filter</span><span class="p">)</span>
    <span class="n">yrx</span> <span class="o">=</span> <span class="n">yrx</span><span class="p">[::</span><span class="n">nsamp</span><span class="p">]</span>  <span class="c1"># downsample</span>

    <span class="n">yrx</span> <span class="o">=</span> <span class="n">yrx</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">delay</span> <span class="o">+</span> <span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">yrx</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">delay</span><span class="p">]</span>

    <span class="n">yi</span> <span class="o">=</span> <span class="n">yrx</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">yq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">yi</span><span class="p">)</span>
    <span class="n">yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">yi</span><span class="p">)</span>

    <span class="n">xrx</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">L</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">yrx</span><span class="p">)):</span>
        <span class="n">differences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="n">yi</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>  <span class="c1"># Array with the differences of the signal from the levels</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">differences</span><span class="p">)</span>
        <span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">differences</span> <span class="o">==</span> <span class="n">m</span><span class="p">)</span>
        <span class="n">yi</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">differences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="n">yq</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>  <span class="c1"># Array with the differences of the signal from the levels</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">differences</span><span class="p">)</span>
        <span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">differences</span> <span class="o">==</span> <span class="n">m</span><span class="p">)</span>
        <span class="n">yq</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="n">error</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">yrx</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">yi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">yq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1</span><span class="n">j</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">+=</span> <span class="mi">1</span> 
    <span class="k">return</span> <span class="n">error</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="c1"># Define the root raised cosine filter function</span>
<span class="k">def</span> <span class="nf">rootRaisedCosine1</span><span class="p">(</span><span class="n">nsamp</span><span class="p">,</span> <span class="n">roll_off</span><span class="p">,</span> <span class="n">delay</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">delay</span><span class="p">,</span> <span class="n">delay</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">nsamp</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">nsamp</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">roll_off</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">roll_off</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="k">elif</span> <span class="n">roll_off</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">roll_off</span><span class="p">):</span>
            <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">roll_off</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">roll_off</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">roll_off</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="n">roll_off</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">roll_off</span><span class="p">):</span>
            <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">roll_off</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">roll_off</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">roll_off</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">roll_off</span><span class="p">))</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">roll_off</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">roll_off</span><span class="p">)))</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">roll_off</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">h</span>


<span class="c1"># Define the BER computation functions</span>
<span class="k">def</span> <span class="nf">compute_ber_psk</span><span class="p">(</span><span class="n">EbNo_dB</span><span class="p">,</span> <span class="n">M1</span><span class="p">):</span>
    <span class="n">EbNo_linear</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">EbNo_dB</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">M1</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># BPSK</span>
        <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">erfc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">EbNo_linear</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># M-PSK</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">erfc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">EbNo_linear</span> <span class="o">*</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">M1</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">psk_errors</span><span class="p">(</span><span class="n">EbNo_dB</span><span class="p">,</span> <span class="n">M1</span><span class="p">):</span>
    <span class="n">Nsymb</span> <span class="o">=</span> <span class="mi">30000</span>  <span class="c1"># Number of symbols</span>
    <span class="n">nsamp</span> <span class="o">=</span> <span class="mi">16</span>  <span class="c1"># Samples per symbol</span>
    <span class="n">fc</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Carrier frequency</span>
    <span class="n">rolloff</span> <span class="o">=</span> <span class="mf">0.25</span>
    <span class="n">delay</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">SNR_dB</span> <span class="o">=</span> <span class="n">EbNo_dB</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">nsamp</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">M1</span><span class="p">))</span>
    <span class="n">shaping_filter</span> <span class="o">=</span> <span class="n">rootRaisedCosine1</span><span class="p">(</span><span class="n">nsamp</span><span class="p">,</span> <span class="n">rolloff</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>
    <span class="n">filtorder</span> <span class="o">=</span> <span class="n">delay</span> <span class="o">*</span> <span class="n">nsamp</span> <span class="o">*</span> <span class="mi">2</span>

    <span class="c1"># Generate random bit stream</span>
    <span class="n">bits1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">M1</span><span class="p">,</span> <span class="n">Nsymb</span><span class="p">)</span>

    <span class="c1"># Map bits to PSK symbols</span>
    <span class="n">symbols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">bits1</span> <span class="o">/</span> <span class="n">M1</span><span class="p">))</span>

    <span class="c1"># Upsample and filter</span>
    <span class="n">ytx1</span> <span class="o">=</span> <span class="n">upfirdn</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">)</span>
    <span class="n">ytx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">ytx1</span><span class="p">,</span> <span class="n">shaping_filter</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
    <span class="n">m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ytx1</span><span class="p">))</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ytx1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fc</span> <span class="o">*</span> <span class="n">m1</span> <span class="o">/</span> <span class="n">nsamp</span><span class="p">))</span>

    <span class="n">Ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">SNR_linear</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">SNR_dB</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">Pn</span> <span class="o">=</span> <span class="n">Ps</span> <span class="o">/</span> <span class="n">SNR_linear</span>
    <span class="k">if</span> <span class="n">M1</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># BPSK</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Pn</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># M-PSK</span>
        <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Pn</span> <span class="o">/</span> <span class="mf">4.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">)))</span>
    <span class="n">snoisy</span> <span class="o">=</span> <span class="n">s1</span> <span class="o">+</span> <span class="n">noise</span>

    <span class="c1"># Receiver</span>
    <span class="n">yrx1</span> <span class="o">=</span> <span class="n">snoisy</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fc</span> <span class="o">*</span> <span class="n">m1</span> <span class="o">/</span> <span class="n">nsamp</span><span class="p">)</span>
    <span class="n">yrx1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">yrx1</span><span class="p">,</span> <span class="n">shaping_filter</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
    <span class="n">yrx1</span> <span class="o">=</span> <span class="n">yrx1</span><span class="p">[::</span><span class="n">nsamp</span><span class="p">]</span>

    <span class="c1"># Demodulate symbols</span>
    <span class="n">detected_bits1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">yrx1</span><span class="p">)</span> <span class="o">*</span> <span class="n">M1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">detected_bits1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">detected_bits1</span><span class="p">)</span> <span class="o">%</span> <span class="n">M1</span>

    <span class="c1"># Calculate BER</span>
    <span class="n">bit_errors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">bits1</span> <span class="o">!=</span> <span class="n">detected_bits1</span><span class="p">)</span>
    <span class="n">ber1</span> <span class="o">=</span> <span class="n">bit_errors1</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">bits1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ber1</span>


<span class="k">def</span> <span class="nf">fsk_errors_coh</span><span class="p">(</span><span class="n">bps</span><span class="p">,</span> <span class="n">Nsymb</span><span class="p">,</span> <span class="n">ns</span><span class="p">,</span> <span class="n">EbNo</span><span class="p">):</span>
    <span class="c1"># Input parameters</span>
    <span class="n">M</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">bps</span>  <span class="c1"># number of different symbols</span>
    <span class="n">BR</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Baud Rate</span>
    <span class="n">fc</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">M</span> <span class="o">*</span> <span class="n">BR</span>  <span class="c1"># RF frequency</span>

    <span class="c1"># Derived parameters</span>
    <span class="n">nb</span> <span class="o">=</span> <span class="n">bps</span> <span class="o">*</span> <span class="n">Nsymb</span>  <span class="c1"># number of simulated data bits</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">BR</span>  <span class="c1"># one symbol period</span>
    <span class="n">Ts</span> <span class="o">=</span> <span class="n">T</span> <span class="o">/</span> <span class="n">ns</span>  <span class="c1"># oversampling period</span>

    <span class="c1"># M frequencies in &quot;coherent&quot; distance (BR)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">fc</span> <span class="o">+</span> <span class="p">(</span><span class="n">BR</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Calculate the maximum frequency</span>
    <span class="n">fmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="c1"># Recalculate ns to ensure Fs = ns * BR &gt; 2 * fmax</span>
    <span class="n">Fs</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">fmax</span>
    <span class="n">ns</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">Fs</span> <span class="o">/</span> <span class="n">BR</span><span class="p">))</span> <span class="o">+</span> <span class="mi">10</span>

    <span class="c1"># Recalculate the oversampling period</span>
    <span class="n">Ts</span> <span class="o">=</span> <span class="n">T</span> <span class="o">/</span> <span class="n">ns</span>

    <span class="c1"># awgn channel</span>
    <span class="n">SNR</span> <span class="o">=</span> <span class="n">EbNo</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">bps</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ns</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># in dB</span>

    <span class="c1"># input data bits</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nb</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">Nsymb</span><span class="p">,</span> <span class="n">bps</span><span class="p">))</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>  <span class="c1"># time vector on the T grid</span>
    <span class="n">tks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Ts</span><span class="p">)</span>  <span class="c1"># oversampling time vector</span>

    <span class="c1"># FSK signal</span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="n">T</span> <span class="o">/</span> <span class="n">ns</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="n">fk</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">])),</span> <span class="mi">2</span><span class="p">)]</span>
        <span class="n">tk</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">tks</span>
        <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fk</span> <span class="o">*</span> <span class="n">tk</span><span class="p">))</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

    <span class="c1"># add noise to the FSK (passband) signal</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">awgn</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">SNR</span><span class="p">)</span>

    <span class="c1"># FSK receiver</span>
    <span class="n">xr</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">//</span> <span class="n">ns</span><span class="p">):</span>
        <span class="n">tk</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">tks</span>
        <span class="n">sk</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">k</span> <span class="o">*</span> <span class="n">ns</span><span class="p">:(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ns</span><span class="p">]</span>
        <span class="n">smi</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">fi</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fi</span> <span class="o">*</span> <span class="n">tk</span><span class="p">)</span>
            <span class="n">smi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sk</span> <span class="o">*</span> <span class="n">si</span><span class="p">))</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">smi</span><span class="p">)</span>
        <span class="n">xr</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">bit</span><span class="p">)</span> <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">(</span><span class="n">j</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="n">bps</span><span class="p">)])</span>
    <span class="n">xr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xr</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">Nsymb</span><span class="p">,</span> <span class="n">bps</span><span class="p">))</span>

    <span class="c1"># count errors</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span> <span class="o">!=</span> <span class="n">xr</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">errors</span>


<span class="k">def</span> <span class="nf">fsk_errors_non_coh</span><span class="p">(</span><span class="n">bps</span><span class="p">,</span> <span class="n">Nsymb</span><span class="p">,</span> <span class="n">ns</span><span class="p">,</span> <span class="n">EbNo</span><span class="p">):</span>
    <span class="n">M</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">bps</span>  <span class="c1"># number of different symbols</span>
    <span class="n">BR</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Baud Rate</span>
    <span class="n">fc</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">M</span> <span class="o">*</span> <span class="n">BR</span>  <span class="c1"># RF frequency</span>

    <span class="c1"># Derived parameters</span>
    <span class="n">nb</span> <span class="o">=</span> <span class="n">bps</span> <span class="o">*</span> <span class="n">Nsymb</span>  <span class="c1"># number of simulated data bits</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">BR</span>  <span class="c1"># one symbol period</span>
    <span class="n">Ts</span> <span class="o">=</span> <span class="n">T</span> <span class="o">/</span> <span class="n">ns</span>  <span class="c1"># oversampling period</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">fc</span> <span class="o">+</span> <span class="n">BR</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># M frequencies</span>

    <span class="c1"># Calculate the maximum frequency</span>
    <span class="n">fmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="c1"># Recalculate ns to ensure Fs = ns * BR &gt; 2 * fmax</span>
    <span class="n">Fs</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">fmax</span>
    <span class="n">ns</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">Fs</span> <span class="o">/</span> <span class="n">BR</span><span class="p">))</span> <span class="o">+</span> <span class="mi">10</span>

    <span class="c1"># Recalculate the oversampling period</span>
    <span class="n">Ts</span> <span class="o">=</span> <span class="n">T</span> <span class="o">/</span> <span class="n">ns</span>

    <span class="c1"># AWGN channel</span>
    <span class="n">SNR</span> <span class="o">=</span> <span class="n">EbNo</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">bps</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ns</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># in dB</span>

    <span class="c1"># input data bits</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nb</span><span class="p">)</span>  <span class="c1"># Ensure integer dimensions</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">bps</span><span class="p">))</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>  <span class="c1"># time vector on the T grid</span>
    <span class="n">tks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Ts</span><span class="p">)</span>

    <span class="c1"># FSK signal</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="n">T</span> <span class="o">/</span> <span class="n">ns</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="n">fk</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">])),</span> <span class="mi">2</span><span class="p">)]</span>
        <span class="n">tk</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">tks</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">s</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fk</span> <span class="o">*</span> <span class="n">tk</span><span class="p">)))</span>

    <span class="c1"># add noise to the FSK (passband) signal</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">awgn</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">SNR</span><span class="p">)</span>

    <span class="c1"># FSK receiver</span>
    <span class="c1"># Non-coherent demodulation</span>
    <span class="n">xr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">//</span> <span class="n">ns</span><span class="p">):</span>
        <span class="n">tk</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">tks</span>
        <span class="n">sk</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">k</span> <span class="o">*</span> <span class="n">ns</span><span class="p">:(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ns</span><span class="p">]</span>
        <span class="n">sm</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
            <span class="n">si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">tk</span><span class="p">))</span>
            <span class="n">sq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">tk</span><span class="p">))</span>
            <span class="n">smi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sk</span> <span class="o">*</span> <span class="n">si</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">sk</span><span class="p">)])</span>
            <span class="n">smq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sk</span> <span class="o">*</span> <span class="n">sq</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">sk</span><span class="p">)])</span>
            <span class="n">sm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">smi</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">smq</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">sm</span><span class="p">)</span>
        <span class="n">xr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">xr</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">binary_repr</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">bps</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)))</span>
    <span class="c1"># count errors</span>
    <span class="n">x_reshaped</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">xr_reshaped</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">not_equal</span><span class="p">(</span><span class="n">x_reshaped</span><span class="p">,</span> <span class="n">xr_reshaped</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">x_reshaped</span><span class="p">)])</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">errors</span>


<span class="c1"># Define the BER values directly inside the functions</span>
<span class="k">def</span> <span class="nf">theoretical_ber_coh</span><span class="p">(</span><span class="n">EbNo</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.15866</span><span class="p">,</span> <span class="mf">0.13093</span><span class="p">,</span> <span class="mf">0.10403</span><span class="p">,</span> <span class="mf">0.078896</span><span class="p">,</span> <span class="mf">0.056495</span><span class="p">,</span>
    <span class="mf">0.037679</span><span class="p">,</span> <span class="mf">0.023007</span><span class="p">,</span> <span class="mf">0.012587</span><span class="p">,</span> <span class="mf">0.0060044</span><span class="p">,</span> <span class="mf">0.0024133</span><span class="p">,</span>
    <span class="mf">0.0007827</span><span class="p">,</span> <span class="mf">0.00019399</span><span class="p">,</span> <span class="mf">3.4303e-05</span><span class="p">,</span> <span class="mf">3.9692e-06</span><span class="p">,</span> <span class="mf">2.6951e-07</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.11814</span><span class="p">,</span> <span class="mf">0.087789</span><span class="p">,</span> <span class="mf">0.060786</span><span class="p">,</span> <span class="mf">0.038512</span><span class="p">,</span> <span class="mf">0.021824</span><span class="p">,</span> 
    <span class="mf">0.010751</span><span class="p">,</span> <span class="mf">0.0044428</span><span class="p">,</span> <span class="mf">0.0014733</span><span class="p">,</span> <span class="mf">0.00037102</span><span class="p">,</span> <span class="mf">6.6229e-05</span><span class="p">,</span> 
    <span class="mf">7.6892e-06</span><span class="p">,</span> <span class="mf">5.2118e-07</span><span class="p">,</span> <span class="mf">1.7997e-08</span><span class="p">,</span> <span class="mf">2.6653e-10</span><span class="p">,</span> <span class="mf">1.362e-12</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.10227</span><span class="p">,</span> <span class="mf">0.067834</span><span class="p">,</span> <span class="mf">0.041318</span><span class="p">,</span> <span class="mf">0.022024</span><span class="p">,</span> <span class="mf">0.0099156</span><span class="p">,</span> 
    <span class="mf">0.0036087</span><span class="p">,</span> <span class="mf">0.0010058</span><span class="p">,</span> <span class="mf">0.00020086</span><span class="p">,</span> <span class="mf">2.6486e-05</span><span class="p">,</span> <span class="mf">2.0836e-06</span><span class="p">,</span> 
    <span class="mf">8.6119e-08</span><span class="p">,</span> <span class="mf">1.5924e-09</span><span class="p">,</span> <span class="mf">1.074e-11</span><span class="p">,</span> <span class="mf">2.0391e-14</span><span class="p">,</span> <span class="mf">7.8524e-18</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.089859</span><span class="p">,</span> <span class="mf">0.055663</span><span class="p">,</span> <span class="mf">0.029957</span><span class="p">,</span> <span class="mf">0.013469</span><span class="p">,</span> <span class="mf">0.004819</span><span class="p">,</span>
    <span class="mf">0.001293</span><span class="p">,</span> <span class="mf">0.00024205</span><span class="p">,</span> <span class="mf">2.897e-05</span><span class="p">,</span> <span class="mf">1.9921e-06</span><span class="p">,</span> <span class="mf">6.8928e-08</span><span class="p">,</span>
    <span class="mf">1.0145e-09</span><span class="p">,</span> <span class="mf">5.1257e-12</span><span class="p">,</span> <span class="mf">6.7629e-15</span><span class="p">,</span> <span class="mf">1.6453e-18</span><span class="p">,</span> <span class="mf">4.6157e-23</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">32</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.082719</span><span class="p">,</span> <span class="mf">0.047105</span><span class="p">,</span> <span class="mf">0.022469</span><span class="p">,</span> <span class="mf">0.0085348</span><span class="p">,</span> <span class="mf">0.0024266</span><span class="p">,</span>
    <span class="mf">0.00047917</span><span class="p">,</span> <span class="mf">6.0083e-05</span><span class="p">,</span> <span class="mf">4.2975e-06</span><span class="p">,</span> <span class="mf">1.5388e-07</span><span class="p">,</span> <span class="mf">2.3425e-09</span><span class="p">,</span>
    <span class="mf">1.2294e-11</span><span class="p">,</span> <span class="mf">1.6992e-14</span><span class="p">,</span> <span class="mf">4.3826e-18</span><span class="p">,</span> <span class="mf">1.3266e-22</span><span class="p">,</span> <span class="mf">2.1688e-28</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported value of M for coherent case&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">theoretical_ber_non_coh</span><span class="p">(</span><span class="n">EbNo</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.30327</span><span class="p">,</span> <span class="mf">0.26644</span><span class="p">,</span> <span class="mf">0.22637</span><span class="p">,</span> <span class="mf">0.18438</span><span class="p">,</span> <span class="mf">0.1424</span><span class="p">,</span> <span class="mf">0.10287</span><span class="p">,</span> 
    <span class="mf">0.068311</span><span class="p">,</span> <span class="mf">0.0408</span><span class="p">,</span> <span class="mf">0.021324</span><span class="p">,</span> <span class="mf">0.0094212</span><span class="p">,</span> <span class="mf">0.003369</span><span class="p">,</span> 
    <span class="mf">0.0009231</span><span class="p">,</span> <span class="mf">0.00018089</span><span class="p">,</span> <span class="mf">2.3244e-05</span><span class="p">,</span> <span class="mf">1.7558e-06</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.22934</span><span class="p">,</span> <span class="mf">0.18475</span><span class="p">,</span> <span class="mf">0.13987</span><span class="p">,</span> <span class="mf">0.097719</span><span class="p">,</span> <span class="mf">0.061557</span><span class="p">,</span> 
    <span class="mf">0.033946</span><span class="p">,</span> <span class="mf">0.01579</span><span class="p">,</span> <span class="mf">0.0059139</span><span class="p">,</span> <span class="mf">0.0016837</span><span class="p">,</span> <span class="mf">0.00033939</span><span class="p">,</span> 
    <span class="mf">4.4371e-05</span><span class="p">,</span> <span class="mf">3.3753e-06</span><span class="p">,</span> <span class="mf">1.3045e-07</span><span class="p">,</span> <span class="mf">2.1593e-09</span><span class="p">,</span> <span class="mf">1.233e-11</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.19472</span><span class="p">,</span> <span class="mf">0.14559</span><span class="p">,</span> <span class="mf">0.099187</span><span class="p">,</span> <span class="mf">0.059806</span><span class="p">,</span> <span class="mf">0.030757</span><span class="p">,</span> 
    <span class="mf">0.012878</span><span class="p">,</span> <span class="mf">0.0041438</span><span class="p">,</span> <span class="mf">0.00095467</span><span class="p">,</span> <span class="mf">0.00014449</span><span class="p">,</span> <span class="mf">1.2945e-05</span><span class="p">,</span> 
    <span class="mf">6.0428e-07</span><span class="p">,</span> <span class="mf">1.2541e-08</span><span class="p">,</span> <span class="mf">9.4638e-11</span><span class="p">,</span> <span class="mf">2.0092e-13</span><span class="p">,</span> <span class="mf">8.6607e-17</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.17469</span><span class="p">,</span> <span class="mf">0.12169</span><span class="p">,</span> <span class="mf">0.074737</span><span class="p">,</span> <span class="mf">0.038861</span><span class="p">,</span> <span class="mf">0.01625</span><span class="p">,</span> 
    <span class="mf">0.005127</span><span class="p">,</span> <span class="mf">0.0011288</span><span class="p">,</span> <span class="mf">0.00015786</span><span class="p">,</span> <span class="mf">1.2538e-05</span><span class="p">,</span> <span class="mf">4.943e-07</span><span class="p">,</span> 
    <span class="mf">8.2001e-09</span><span class="p">,</span> <span class="mf">4.6432e-11</span><span class="p">,</span> <span class="mf">6.8517e-14</span><span class="p">,</span> <span class="mf">1.8682e-17</span><span class="p">,</span> <span class="mf">6.0826e-22</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">32</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.16103</span><span class="p">,</span> <span class="mf">0.10471</span><span class="p">,</span> <span class="mf">0.058014</span><span class="p">,</span> <span class="mf">0.025984</span><span class="p">,</span> <span class="mf">0.0088058</span><span class="p">,</span> 
    <span class="mf">0.0020817</span><span class="p">,</span> <span class="mf">0.00031127</span><span class="p">,</span> <span class="mf">2.6219e-05</span><span class="p">,</span> <span class="mf">1.0859e-06</span><span class="p">,</span> <span class="mf">1.8789e-08</span><span class="p">,</span> 
    <span class="mf">1.1086e-10</span><span class="p">,</span> <span class="mf">1.7154e-13</span><span class="p">,</span> <span class="mf">4.9582e-17</span><span class="p">,</span> <span class="mf">1.737e-21</span><span class="p">,</span> <span class="mf">4.2722e-27</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported value of M for non-coherent case&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">msk_errors</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">,</span> <span class="n">EbN0_db</span><span class="p">,</span> <span class="n">precoding</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">Nbits</span> <span class="o">=</span> <span class="mi">10000</span>  <span class="c1"># number of data bits</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">Nbits</span>
    <span class="n">R</span> <span class="o">=</span> <span class="mi">2000000</span>  <span class="c1"># bit rate</span>
    <span class="n">fc</span> <span class="o">=</span> <span class="mi">8000000</span>  <span class="c1"># carrier frequency</span>
    <span class="n">ns</span> <span class="o">=</span> <span class="n">nsamp</span>  <span class="c1"># oversampling factor</span>
    <span class="n">EbNo</span> <span class="o">=</span> <span class="n">EbN0_db</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">precoding</span><span class="p">):</span>
        <span class="c1"># AWGN channel</span>
        <span class="n">SNR</span> <span class="o">=</span> <span class="n">EbNo</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ns</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># in dB</span>
        <span class="n">T</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">R</span>  <span class="c1"># 1-bit period (= basic period)</span>
        <span class="n">Ts</span> <span class="o">=</span> <span class="n">T</span> <span class="o">/</span> <span class="n">ns</span>  <span class="c1"># sampling frequency</span>
        <span class="n">fss</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ts</span>

        <span class="c1"># Input sequence</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)))</span>  <span class="c1"># random numbers, -1 or 1</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">y</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">upfirdn</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">up</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>  <span class="c1"># NRZ polar pulse train samples</span>

        <span class="c1"># Time grid</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ts</span><span class="p">,</span> <span class="n">Ts</span><span class="p">)</span>  <span class="c1"># of length ns*(n+1)</span>

        <span class="c1">## MSK TRANSMITTER</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="n">xx</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">ns</span>
        <span class="n">xs_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>  <span class="c1"># in-phase component</span>
        <span class="n">xs_q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>  <span class="c1"># quadrature component</span>

        <span class="c1"># Ensure that xs_i and xs_q are the same length as the time grid `ts`</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs_i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">):</span>
            <span class="n">xs_i</span> <span class="o">=</span> <span class="n">xs_i</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">)]</span>
            <span class="n">xs_q</span> <span class="o">=</span> <span class="n">xs_q</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs_i</span><span class="p">):</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">xs_i</span><span class="p">)]</span>

        <span class="c1"># Modulation</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">xs_i</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fc</span> <span class="o">*</span> <span class="n">ts</span><span class="p">)</span> <span class="o">-</span> <span class="n">xs_q</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fc</span> <span class="o">*</span> <span class="n">ts</span><span class="p">)</span>

        <span class="c1"># Addition of noise</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">awgn</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">SNR</span><span class="p">)</span>

        <span class="c1">## MSK RECEIVER</span>
        <span class="n">xs_i</span> <span class="o">=</span> <span class="n">s</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fc</span> <span class="o">*</span> <span class="n">ts</span><span class="p">)</span>
        <span class="n">xs_q</span> <span class="o">=</span> <span class="o">-</span><span class="n">s</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fc</span> <span class="o">*</span> <span class="n">ts</span><span class="p">)</span>

        <span class="c1"># LP (Parks-McClellan) filter</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="mf">0.75</span><span class="o">*</span><span class="p">(</span><span class="n">fss</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">ns</span>
        <span class="n">f2</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">f1</span>
        <span class="n">order</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">ns</span>
        <span class="n">fpts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">fss</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">mag</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">wt</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">firwin2</span><span class="p">(</span><span class="n">order</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">fpts</span><span class="p">,</span> <span class="n">mag</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fss</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">len_xs_i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs_i</span><span class="p">)</span>
        <span class="n">dummy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">xs_i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">order</span><span class="p">)))</span>
        <span class="n">dummy1</span> <span class="o">=</span> <span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dummy</span><span class="p">)</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="n">order</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">xs_i</span> <span class="o">=</span> <span class="n">dummy1</span><span class="p">[</span><span class="n">delay</span><span class="p">:</span><span class="n">delay</span> <span class="o">+</span> <span class="n">len_xs_i</span><span class="p">]</span>
        <span class="n">xs_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">xs_i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nsamp</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>

        <span class="n">dummy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">xs_q</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">order</span><span class="p">)))</span>
        <span class="n">dummy1</span> <span class="o">=</span> <span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dummy</span><span class="p">)</span>
        <span class="n">xs_q</span> <span class="o">=</span> <span class="n">dummy1</span><span class="p">[</span><span class="n">delay</span><span class="p">:</span><span class="n">delay</span> <span class="o">+</span> <span class="n">len_xs_i</span><span class="p">]</span>

        <span class="n">bi</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">xr_1</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">xr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">li</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">((</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ns</span><span class="p">,</span> <span class="nb">min</span><span class="p">((</span><span class="n">k</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">ns</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs_i</span><span class="p">)))</span>
            <span class="n">lq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">ns</span><span class="p">,</span> <span class="nb">min</span><span class="p">((</span><span class="n">k</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">ns</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs_q</span><span class="p">)))</span>
            <span class="n">xi</span> <span class="o">=</span> <span class="n">xs_i</span><span class="p">[</span><span class="n">li</span><span class="p">]</span>
            <span class="n">xq</span> <span class="o">=</span> <span class="n">xs_q</span><span class="p">[</span><span class="n">lq</span><span class="p">]</span>
            <span class="n">gmi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">T</span> <span class="o">*</span> <span class="n">Ts</span> <span class="o">*</span> <span class="n">li</span><span class="p">)</span>  <span class="c1"># matched-filter pulse</span>
            <span class="n">gmq</span> <span class="o">=</span> <span class="o">-</span><span class="n">gmi</span>  <span class="c1"># =sin(pi/2/T*Ts*lq);</span>
            <span class="n">bi_1</span> <span class="o">=</span> <span class="n">bi</span>
            <span class="n">bi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xi</span> <span class="o">*</span> <span class="n">gmi</span><span class="p">))</span>
            <span class="n">bq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xq</span> <span class="o">*</span> <span class="n">gmq</span><span class="p">))</span>
            <span class="n">xr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">bi_1</span> <span class="o">*</span> <span class="n">bq</span>
            <span class="n">xr</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">bi</span> <span class="o">*</span> <span class="n">bq</span>
            <span class="n">xr_1</span> <span class="o">=</span> <span class="n">xr</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

        <span class="n">xr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">not_equal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xr</span><span class="p">)</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">errors</span> <span class="o">/</span> <span class="n">Nbits</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># AWGN channel</span>
        <span class="n">SNR</span> <span class="o">=</span> <span class="n">EbNo</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ns</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># in dB</span>
        <span class="n">T</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">R</span>  <span class="c1"># 1-bit period (= basic period)</span>
        <span class="n">Ts</span> <span class="o">=</span> <span class="n">T</span> <span class="o">/</span> <span class="n">ns</span>  <span class="c1"># sampling frequency</span>
        <span class="n">fss</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">Ts</span>

        <span class="c1"># Input sequence</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)))</span>  <span class="c1"># random numbers, -1 or 1</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">y</span>
        <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
            <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Apply precoding rule</span>

            

        <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">upfirdn</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">up</span><span class="o">=</span><span class="n">ns</span><span class="p">)</span>  <span class="c1"># NRZ polar pulse train samples</span>

        <span class="c1"># Time grid</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ts</span><span class="p">,</span> <span class="n">Ts</span><span class="p">)</span>  <span class="c1"># of length ns*(n+1)</span>

        <span class="c1">## MSK TRANSMITTER</span>
        <span class="n">xs</span> <span class="o">=</span> <span class="n">xx</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">ns</span>
        <span class="n">xs_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>  <span class="c1"># in-phase component</span>
        <span class="n">xs_q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>  <span class="c1"># quadrature component</span>

        <span class="c1"># Ensure that xs_i and xs_q are the same length as the time grid ts</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs_i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">):</span>
            <span class="n">xs_i</span> <span class="o">=</span> <span class="n">xs_i</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">)]</span>
            <span class="n">xs_q</span> <span class="o">=</span> <span class="n">xs_q</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs_i</span><span class="p">):</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">xs_i</span><span class="p">)]</span>

        <span class="c1"># Modulation</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">xs_i</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fc</span> <span class="o">*</span> <span class="n">ts</span><span class="p">)</span> <span class="o">-</span> <span class="n">xs_q</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fc</span> <span class="o">*</span> <span class="n">ts</span><span class="p">)</span>

        <span class="c1"># Addition of noise</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">awgn</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">SNR</span><span class="p">)</span>

        <span class="c1">## MSK RECEIVER</span>
        <span class="n">xs_i</span> <span class="o">=</span> <span class="n">s</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fc</span> <span class="o">*</span> <span class="n">ts</span><span class="p">)</span>
        <span class="n">xs_q</span> <span class="o">=</span> <span class="o">-</span><span class="n">s</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fc</span> <span class="o">*</span> <span class="n">ts</span><span class="p">)</span>

        <span class="c1"># LP (Parks-McClellan) filter</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="mf">0.75</span><span class="o">*</span><span class="p">(</span><span class="n">fss</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">ns</span>
        <span class="n">f2</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">f1</span>
        <span class="n">order</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">ns</span>
        <span class="n">fpts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">fss</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">mag</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">wt</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">firwin2</span><span class="p">(</span><span class="n">order</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">fpts</span><span class="p">,</span> <span class="n">mag</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fss</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">len_xs_i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs_i</span><span class="p">)</span>
        <span class="n">dummy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">xs_i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">order</span><span class="p">)))</span>
        <span class="n">dummy1</span> <span class="o">=</span> <span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dummy</span><span class="p">)</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="n">order</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">xs_i</span> <span class="o">=</span> <span class="n">dummy1</span><span class="p">[</span><span class="n">delay</span><span class="p">:</span><span class="n">delay</span> <span class="o">+</span> <span class="n">len_xs_i</span><span class="p">]</span>
        <span class="n">xs_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">xs_i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nsamp</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>

        <span class="n">dummy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">xs_q</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">order</span><span class="p">)))</span>
        <span class="n">dummy1</span> <span class="o">=</span> <span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">dummy</span><span class="p">)</span>
        <span class="n">xs_q</span> <span class="o">=</span> <span class="n">dummy1</span><span class="p">[</span><span class="n">delay</span><span class="p">:</span><span class="n">delay</span> <span class="o">+</span> <span class="n">len_xs_i</span><span class="p">]</span>

        <span class="c1"># Updated MSK decoding for precoded bits with recursive logic</span>
        <span class="n">bi</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">xr_1</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Initialize previous decoded bit (xr_1)</span>
        <span class="n">xr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># Array to store decoded bits</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">li</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">((</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ns</span><span class="p">,</span> <span class="nb">min</span><span class="p">((</span><span class="n">k</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">ns</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs_i</span><span class="p">)))</span>
            <span class="n">lq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">ns</span><span class="p">,</span> <span class="nb">min</span><span class="p">((</span><span class="n">k</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">ns</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs_q</span><span class="p">)))</span>
            <span class="n">xi</span> <span class="o">=</span> <span class="n">xs_i</span><span class="p">[</span><span class="n">li</span><span class="p">]</span>
            <span class="n">xq</span> <span class="o">=</span> <span class="n">xs_q</span><span class="p">[</span><span class="n">lq</span><span class="p">]</span>
            
            <span class="c1"># Matched filter output (to match MSK modulation characteristics)</span>
            <span class="n">gmi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">T</span> <span class="o">*</span> <span class="n">Ts</span> <span class="o">*</span> <span class="n">li</span><span class="p">)</span>  <span class="c1"># In-phase matched filter pulse</span>
            <span class="n">gmq</span> <span class="o">=</span> <span class="o">-</span><span class="n">gmi</span>  <span class="c1"># Quadrature matched-filter pulse (sin is negative of cosine)</span>
            
            <span class="c1"># Save previous in-phase matched filter output</span>
            <span class="n">bi_1</span> <span class="o">=</span> <span class="n">bi</span>
            
            <span class="c1"># Decode in-phase (I) and quadrature (Q) components</span>
            <span class="n">bi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xi</span> <span class="o">*</span> <span class="n">gmi</span><span class="p">))</span>
            <span class="n">bq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xq</span> <span class="o">*</span> <span class="n">gmq</span><span class="p">))</span>
            
            <span class="c1"># Apply recursive decoding rule for precoded MSK</span>
            <span class="n">xr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">bi_1</span> <span class="o">*</span> <span class="n">bq</span>  <span class="c1"># Decode the k-th bit</span>
            <span class="n">xr</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">bi</span> <span class="o">*</span> <span class="n">bq</span>  <span class="c1"># Decode the (k+1)-th bit</span>
            
            <span class="c1"># Update the previously decoded bit (xr_1)</span>
            <span class="n">xr_1</span> <span class="o">=</span> <span class="n">xr</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">xr</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">not_equal</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">xr</span><span class="p">)</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">errors</span> <span class="o">/</span> <span class="n">Nbits</span>

    <span class="k">return</span> <span class="n">result</span>


<span class="n">M</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">nsamp</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">EbN0_db</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> 
<span class="n">EbN0</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">EbN0_db</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">EbNo_dB_theory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Eb/No values in dB for theoretical</span>
<span class="n">EbNo_theory</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">EbNo_dB_theory</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># convert dB to linear for theoretical</span>

<span class="k">def</span> <span class="nf">plot_selected_modulations</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
    <span class="c1"># Start the timer</span>
    <span class="n">loader_html3</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">loading</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="k">with</span> <span class="n">plot_output</span><span class="p">:</span>
        <span class="n">loader_html3</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">loading</span>
        <span class="n">plot_output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
        
        <span class="n">modulation</span> <span class="o">=</span> <span class="n">modulation_dropdown</span><span class="o">.</span><span class="n">value</span>
        <span class="n">level</span> <span class="o">=</span> <span class="n">levels_dropdown</span><span class="o">.</span><span class="n">value</span>
        <span class="k">if</span> <span class="n">level</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">modulation</span> <span class="o">==</span> <span class="s1">&#39;MSK&#39;</span><span class="p">:</span>
            <span class="n">L</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">L</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">level</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">L1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
        <span class="n">modulation_name</span> <span class="o">=</span> <span class="n">level</span>
        
        <span class="k">if</span> <span class="n">modulation</span> <span class="o">==</span> <span class="s1">&#39;ASK&#39;</span><span class="p">:</span>
            <span class="n">ber</span> <span class="o">=</span> <span class="p">[</span><span class="n">ask_errors</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span> <span class="o">/</span> <span class="n">M</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">EbN0_db</span><span class="p">]</span>
            <span class="n">ber_theoretical</span> <span class="o">=</span> <span class="p">(((</span><span class="n">L</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">L</span><span class="p">)</span> <span class="o">*</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">erfc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">EbN0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">L</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))))</span> <span class="o">/</span> <span class="n">k</span>
        <span class="k">elif</span> <span class="n">modulation</span> <span class="o">==</span> <span class="s1">&#39;QAM&#39;</span><span class="p">:</span>
            <span class="n">roll_off</span> <span class="o">=</span> <span class="n">roll_off_input</span><span class="o">.</span><span class="n">value</span>
            <span class="n">F1</span> <span class="o">=</span> <span class="mf">6.75</span>
            <span class="n">F2</span> <span class="o">=</span> <span class="mf">9.25</span>
            <span class="n">Br</span> <span class="o">=</span> <span class="n">Br_input</span><span class="o">.</span><span class="n">value</span>
            <span class="n">ber</span> <span class="o">=</span> <span class="p">[</span><span class="n">qam_errors</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">roll_off</span><span class="p">,</span> <span class="n">F1</span><span class="p">,</span> <span class="n">F2</span><span class="p">,</span> <span class="n">Br</span><span class="p">)</span> <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">EbN0_db</span><span class="p">]</span>
            <span class="n">ber_theoretical</span> <span class="o">=</span> <span class="p">[((</span><span class="n">L1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="n">L1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">L1</span><span class="p">))</span> <span class="o">*</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">erfc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">L1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">L1</span> <span class="o">*</span> <span class="n">L1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">db</span><span class="o">/</span><span class="mi">10</span><span class="p">))))</span> <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">EbN0_db</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">modulation</span> <span class="o">==</span> <span class="s1">&#39;PSK&#39;</span><span class="p">:</span>
            <span class="n">ber</span> <span class="o">=</span> <span class="p">[</span><span class="n">psk_errors</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">EbN0_db</span><span class="p">]</span>
            <span class="n">ber_theoretical</span> <span class="o">=</span> <span class="p">[</span><span class="n">compute_ber_psk</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span> <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">EbN0_db</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">modulation</span> <span class="o">==</span> <span class="s1">&#39;FSK&#39;</span><span class="p">:</span>
            <span class="n">ber_coh</span> <span class="o">=</span> <span class="p">[</span><span class="n">fsk_errors_coh</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span> <span class="o">/</span> <span class="n">M</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">EbN0_db</span><span class="p">]</span>
            <span class="n">ber_non_coh</span> <span class="o">=</span> <span class="p">[</span><span class="n">fsk_errors_non_coh</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span> <span class="o">/</span> <span class="n">M</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">EbN0_db</span><span class="p">]</span>
            <span class="n">ber_coh_theoretical</span> <span class="o">=</span> <span class="n">theoretical_ber_coh</span><span class="p">(</span><span class="n">EbNo_theory</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
            <span class="n">ber_non_coh_theoretical</span> <span class="o">=</span> <span class="n">theoretical_ber_non_coh</span><span class="p">(</span><span class="n">EbNo_theory</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">EbN0_db</span><span class="p">,</span> <span class="n">ber_coh</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Experimental Coherent </span><span class="si">{</span><span class="n">modulation_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#1F77B4&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">EbN0_db</span><span class="p">,</span> <span class="n">ber_non_coh</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Experimental Non-Coherent </span><span class="si">{</span><span class="n">modulation_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#FF7F0E&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">modulation</span> <span class="o">==</span> <span class="s1">&#39;MSK&#39;</span><span class="p">:</span>
            <span class="n">EbNo_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">ber</span> <span class="o">=</span> <span class="p">[</span><span class="n">msk_errors</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">precoding</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">EbNo_range</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">levels_dropdown</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;MSK (with precoding)&#39;</span><span class="p">:</span>
                <span class="n">ber_theoretical</span> <span class="o">=</span> <span class="p">[(</span><span class="n">erfc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">db</span> <span class="o">/</span> <span class="mi">10</span><span class="p">))))</span> <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">EbNo_range</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ber_theoretical</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.9</span> <span class="o">*</span> <span class="n">erfc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">db</span> <span class="o">/</span> <span class="mi">10</span><span class="p">))))</span> <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">EbNo_range</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">modulation</span> <span class="o">==</span> <span class="s1">&#39;MSK&#39;</span><span class="p">:</span>
            <span class="n">EbNo_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">EbNo_range</span><span class="p">,</span> <span class="n">ber_theoretical</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Theoretical </span><span class="si">{</span><span class="n">modulation_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">EbNo_range</span><span class="p">,</span> <span class="n">ber</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Experimental </span><span class="si">{</span><span class="n">modulation_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">modulation</span> <span class="o">!=</span> <span class="s1">&#39;FSK&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">EbN0_db</span><span class="p">,</span> <span class="n">ber_theoretical</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Theoretical </span><span class="si">{</span><span class="n">modulation_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">EbN0_db</span><span class="p">,</span> <span class="n">ber</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Experimental </span><span class="si">{</span><span class="n">modulation_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">EbNo_dB_theory</span><span class="p">,</span> <span class="n">ber_coh_theoretical</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Theoretical Coherent </span><span class="si">{</span><span class="n">modulation_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">EbNo_dB_theory</span><span class="p">,</span> <span class="n">ber_non_coh_theoretical</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Theoretical Non-Coherent </span><span class="si">{</span><span class="n">modulation_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Eb/N0 (dB)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Bit Error Rate&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">modulation_name</span><span class="si">}</span><span class="s1"> | Theoretical and Experimental BER&#39;</span><span class="p">)</span>

        <span class="c1"># Show elapsed time</span>
        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="n">timer_html3</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Elapsed time: </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span>
        <span class="n">loader_html3</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">done</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># Define additional input boxes for roll-off, F1, F2, and Br</span>
<span class="n">roll_off_input</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Roll-off:&#39;</span><span class="p">)</span>
<span class="n">F1_input</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">6.75</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;F1: (MHz)&#39;</span><span class="p">)</span>
<span class="n">F2_input</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">9.25</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;F2: (MHz)&#39;</span><span class="p">)</span>
<span class="n">Br_input</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">FloatText</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Br: (Mbps)&#39;</span><span class="p">)</span>

<span class="c1"># Container for QAM specific inputs</span>
<span class="n">qam_inputs</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">roll_off_input</span><span class="p">,</span> <span class="n">Br_input</span><span class="p">])</span>

<span class="c1"># Define the plot button</span>
<span class="n">plot_button</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Plot&quot;</span><span class="p">,</span> <span class="n">button_style</span><span class="o">=</span><span class="s1">&#39;primary&#39;</span><span class="p">)</span>

<span class="c1"># Attach the plot_selected_modulations function to the &#39;click&#39; event of the button</span>
<span class="n">plot_button</span><span class="o">.</span><span class="n">on_click</span><span class="p">(</span><span class="n">plot_selected_modulations</span><span class="p">)</span>

<span class="n">inputs</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">modulation_dropdown</span><span class="p">,</span> <span class="n">levels_dropdown</span><span class="p">])</span>

<span class="c1"># Group the loader and timer together (they will appear next to each other horizontally)</span>
<span class="n">loader_timer_box</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">loader_html3</span><span class="p">,</span> <span class="n">timer_html3</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">margin</span><span class="o">=</span><span class="s1">&#39;0 0 0 20px&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">))</span>

<span class="n">inputs_ui</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">inputs</span><span class="p">,</span> <span class="n">loader_timer_box</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">align_items</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">))</span>

<span class="n">ui</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">inputs_ui</span><span class="p">,</span> <span class="n">plot_button</span><span class="p">])</span> 

<span class="c1"># Update the UI to include QAM specific inputs conditionally</span>
<span class="k">def</span> <span class="nf">update_ui</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">modulation_dropdown</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;QAM&#39;</span><span class="p">:</span>
        <span class="n">inputs_ui</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">inputs</span><span class="p">,</span> <span class="n">qam_inputs</span><span class="p">,</span> <span class="n">loader_timer_box</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">inputs_ui</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">inputs</span><span class="p">,</span> <span class="n">loader_timer_box</span><span class="p">]</span>

<span class="c1"># Attach the update_ui function to the &#39;value&#39; property of the modulation dropdown</span>
<span class="n">modulation_dropdown</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update_ui</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="c1"># Call the update_ui function initially to set the correct UI state</span>
<span class="n">update_ui</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># Setup the display layout</span>
<span class="n">display</span><span class="p">(</span><span class="n">ui</span><span class="p">,</span> <span class="n">plot_output</span><span class="p">)</span>

<span class="c1"># Display the initial plot</span>
<span class="n">plot_selected_modulations</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "15f82bed61c24f0194d486d5194ed311", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "32263011a84946f5a3f85a121cff8676", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "ntua-el17840/Interactive-Digital-Communications",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Digcom_Lab6.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lab Exercise 6: FSK-MSK</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-packages-we-will-need-later-in-python">Importing packages we will need later in Python</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bit-error-rate-tool">Bit Error Rate Tool</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By ECE - NTUA
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>